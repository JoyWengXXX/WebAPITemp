<h1>即時聊天範例</h1>

<div class="row mt-3">
    <div class="col-12">
        <h3>聊天內容</h3>
        <ul class="list-group" id="Content">
        </ul>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script>
	var connection = new signalR.HubConnectionBuilder().withUrl("https://localhost:44372/chatHub", {
																  skipNegotiation: true,
																  transport: signalR.HttpTransportType.WebSockets,
																  accessTokenFactory: () => ""
																}).build();

	//與Server建立連線
	connection.start().then(function () {
		console.log("Hub 連線完成");
	}).catch(function (err) {
		alert('連線錯誤: ' + err.toString());
	});

	// 更新連線 ID 列表事件
	connection.on("UpdList", function (jsonList) {
		var list = JSON.parse(jsonList);
		$("#IDList li").remove();
		for(i=0; i<list.length; i++)
		{
			$("#IDList").append($("<li></li>").attr("class", "list-group-item").text(list[i]));
		}
	});

	// 更新聊天內容事件
	connection.on("UpdContent", function (msg) {
		$("#Content").append($("<li></li>").attr("class", "list-group-item").text(msg));
	});
</script>